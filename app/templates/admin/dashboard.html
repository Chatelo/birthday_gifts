{% extends 'base.html' %} {% block title %}Admin Dashboard{% endblock %} {%
block extra_css %}
<style>
  .nav-link {
    @apply px-4 py-2 rounded-md transition duration-200;
  }
  .nav-link.active {
    @apply bg-blue-600 text-white;
  }
  .nav-link:not(.active) {
    @apply text-gray-700 hover:bg-gray-100;
  }
</style>
{% endblock %} {% block content %}
<div class="max-w-7xl mx-auto">
  <!-- Admin Header -->
  <div
    class="bg-white rounded-lg shadow-md p-6 mb-6 flex flex-col md:flex-row justify-between items-center"
  >
    <div>
      <h1 class="text-3xl font-bold text-gray-800">Admin Dashboard</h1>
      <p class="text-gray-600">
        Welcome to the birthday celebration management dashboard
      </p>
    </div>
    <div class="mt-4 md:mt-0">
      <a
        href="{{ url_for('admin_panel.logout') }}"
        class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition duration-200"
        >Logout</a
      >
    </div>
  </div>

  <!-- Admin Navigation -->
  <div class="mb-6 bg-white rounded-lg shadow-md p-4">
    <nav class="flex flex-wrap gap-2">
      <a href="{{ url_for('admin_panel.dashboard') }}" class="nav-link active"
        >Dashboard</a
      >
      <a href="{{ url_for('admin_panel.messages') }}" class="nav-link"
        >Messages</a
      >
      <a href="{{ url_for('admin_panel.contributions') }}" class="nav-link"
        >Contributions</a
      >
      <a href="{{ url_for('admin_panel.users') }}" class="nav-link">Users</a>
      <a href="{{ url_for('admin_panel.events') }}" class="nav-link">Events</a>
    </nav>
  </div>

  <!-- Stats Overview -->
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
    <!-- Users Stat -->
    <div class="bg-white rounded-lg shadow-md p-6">
      <div class="flex items-center">
        <div class="bg-blue-100 p-3 rounded-full">
          <svg
            class="w-8 h-8 text-blue-600"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"
            ></path>
          </svg>
        </div>
        <div class="ml-4">
          <h2 class="text-gray-600 text-sm font-medium">Total Users</h2>
          <p class="text-2xl font-bold text-gray-900">{{ users_count }}</p>
        </div>
      </div>
    </div>

    <!-- Messages Stat -->
    <div class="bg-white rounded-lg shadow-md p-6">
      <div class="flex items-center">
        <div class="bg-green-100 p-3 rounded-full">
          <svg
            class="w-8 h-8 text-green-600"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"
            ></path>
          </svg>
        </div>
        <div class="ml-4">
          <h2 class="text-gray-600 text-sm font-medium">Total Messages</h2>
          <p class="text-2xl font-bold text-gray-900">{{ messages_count }}</p>
        </div>
      </div>
    </div>

    <!-- Contributions Stat -->
    <div class="bg-white rounded-lg shadow-md p-6">
      <div class="flex items-center">
        <div class="bg-yellow-100 p-3 rounded-full">
          <svg
            class="w-8 h-8 text-yellow-600"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
            ></path>
          </svg>
        </div>
        <div class="ml-4">
          <h2 class="text-gray-600 text-sm font-medium">Contributions</h2>
          <p class="text-2xl font-bold text-gray-900">
            {{ contributions_count }}
          </p>
        </div>
      </div>
    </div>

    <!-- Total Amount -->
    <div class="bg-white rounded-lg shadow-md p-6">
      <div class="flex items-center">
        <div class="bg-purple-100 p-3 rounded-full">
          <svg
            class="w-8 h-8 text-purple-600"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"
            ></path>
          </svg>
        </div>
        <div class="ml-4">
          <h2 class="text-gray-600 text-sm font-medium">Total Amount</h2>
          <p class="text-2xl font-bold text-gray-900">
            KES {{ "%.2f"|format(total_amount) }}
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Recent Activities -->
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
    <!-- Recent Users -->
    <div class="bg-white rounded-lg shadow-md">
      <div class="border-b px-6 py-4">
        <h2 class="font-bold text-lg">Recent Users</h2>
      </div>
      <div class="p-6">
        {% if recent_users %}
        <ul class="divide-y">
          {% for user in recent_users %}
          <li class="py-3">
            <div class="flex items-center">
              <div class="flex-1">
                <h3 class="font-medium">{{ user.name }}</h3>
                <p class="text-sm text-gray-500">{{ user.email }}</p>
              </div>
              <div class="text-sm text-gray-500">
                {{ user.created_at.strftime('%d/%m/%Y') }}
              </div>
            </div>
          </li>
          {% endfor %}
        </ul>
        <div class="mt-4">
          <a
            href="{{ url_for('admin_panel.users') }}"
            class="text-blue-600 text-sm hover:underline"
            >View all users</a
          >
        </div>
        {% else %}
        <p class="text-gray-500 text-center py-4">No users found</p>
        {% endif %}
      </div>
    </div>

    <!-- Recent Messages -->
    <div class="bg-white rounded-lg shadow-md">
      <div class="border-b px-6 py-4">
        <h2 class="font-bold text-lg">Recent Messages</h2>
      </div>
      <div class="p-6">
        {% if recent_messages %}
        <ul class="divide-y">
          {% for message in recent_messages %}
          <li class="py-3">
            <div>
              <div class="flex justify-between">
                <h3 class="font-medium">{{ message.author.name }}</h3>
                <span class="text-xs text-gray-500"
                  >{{ message.created_at.strftime('%d/%m/%Y') }}</span
                >
              </div>
              <p class="text-sm text-gray-600 mt-1 line-clamp-2">
                {{ message.content }}
              </p>
            </div>
          </li>
          {% endfor %}
        </ul>
        <div class="mt-4">
          <a
            href="{{ url_for('admin_panel.messages') }}"
            class="text-blue-600 text-sm hover:underline"
            >View all messages</a
          >
        </div>
        {% else %}
        <p class="text-gray-500 text-center py-4">No messages found</p>
        {% endif %}
      </div>
    </div>

    <!-- Recent Contributions -->
    <div class="bg-white rounded-lg shadow-md">
      <div class="border-b px-6 py-4">
        <h2 class="font-bold text-lg">Recent Contributions</h2>
      </div>
      <div class="p-6">
        {% if recent_contributions %}
        <ul class="divide-y">
          {% for contribution in recent_contributions %}
          <li class="py-3">
            <div class="flex items-center">
              <div class="flex-1">
                <h3 class="font-medium">{{ contribution.contributor.name }}</h3>
                <p class="text-sm text-gray-500">
                  KES {{ "%.2f"|format(contribution.amount) }}
                </p>
              </div>
              <div>
                {% if contribution.status == 'completed' %}
                <span
                  class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full"
                  >Completed</span
                >
                {% elif contribution.status == 'pending' %}
                <span
                  class="px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full"
                  >Pending</span
                >
                {% else %}
                <span
                  class="px-2 py-1 bg-red-100 text-red-800 text-xs rounded-full"
                  >Failed</span
                >
                {% endif %}
              </div>
            </div>
          </li>
          {% endfor %}
        </ul>
        <div class="mt-4">
          <a
            href="{{ url_for('admin_panel.contributions') }}"
            class="text-blue-600 text-sm hover:underline"
            >View all contributions</a
          >
        </div>
        {% else %}
        <p class="text-gray-500 text-center py-4">No contributions found</p>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
